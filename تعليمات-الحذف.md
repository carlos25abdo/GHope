# تعليمات إعداد نظام حذف المحلات من Google Sheets

## المشكلة
زر الحذف حالياً يحذف المحل من الذاكرة فقط ولا يحذفه من Google Sheets (Excel).

## الحلول المتاحة

### الحل الأول: Google Apps Script (الأفضل)

#### الخطوة 1: إنشاء Google Apps Script
1. اذهب إلى [Google Apps Script](https://script.google.com/)
2. اضغط على "New Project" (مشروع جديد)
3. احذف الكود الموجود واستبدله بالكود من ملف `google-apps-script.js`
4. احفظ المشروع باسم "حذف المحلات"

#### الخطوة 2: نشر المشروع كـ Web App
1. اضغط على "Deploy" (نشر)
2. اختر "New deployment" (نشر جديد)
3. اختر "Web app" (تطبيق ويب)
4. املأ البيانات:
   - **Execute as**: Me (أنا)
   - **Who has access**: Anyone (أي شخص)
5. اضغط "Deploy" (نشر)
6. انسخ رابط النشر (Web App URL)

#### الخطوة 3: تحديث الكود في الموقع
1. افتح ملف `list.html`
2. ابحث عن السطر:
   ```javascript
   const DELETE_SCRIPT_URL = "https://script.google.com/macros/s/YOUR_SCRIPT_ID/exec";
   ```
3. استبدل `YOUR_SCRIPT_ID` برابط النشر الذي حصلت عليه

#### الخطوة 4: اختبار النظام
1. افتح الموقع
2. جرب حذف محل
3. تحقق من Google Sheets للتأكد من حذف الصف

### الحل الثاني: Google Form للحذف (بديل)

#### الخطوة 1: إنشاء Google Form جديد
1. اذهب إلى [Google Forms](https://forms.google.com/)
2. أنشئ نموذج جديد باسم "حذف المحلات"
3. أضف حقل نص باسم "اسم المحل المراد حذفه"
4. احفظ النموذج

#### الخطوة 2: الحصول على رابط النموذج
1. اضغط على "Send" (إرسال)
2. انسخ رابط النموذج
3. استخرج معرف النموذج من الرابط

#### الخطوة 3: تحديث الكود
1. افتح ملف `list.html`
2. ابحث عن السطر:
   ```javascript
   const DELETE_FORM_URL = "https://docs.google.com/forms/u/0/d/e/YOUR_DELETE_FORM_ID/formResponse";
   ```
3. استبدل `YOUR_DELETE_FORM_ID` بمعرف النموذج الجديد

#### الخطوة 4: تحديث حقل الإدخال
1. في Google Form، اضغط على "Responses" (الردود)
2. اضغط على "Create spreadsheet" (إنشاء جدول بيانات)
3. انسخ معرف الجدول الجديد
4. استبدل `SHEET_ID` في الكود بمعرف الجدول الجديد

### الحل الثالث: الحذف اليدوي (مؤقت)

إذا لم ترد إعداد أي من الحلين السابقين، يمكنك:

1. فتح Google Sheets
2. البحث عن المحل المراد حذفه
3. تحديد الصف بالكامل
4. الضغط على زر Delete (حذف)

## ملاحظات مهمة

### أمان Google Apps Script
- تأكد من أن لديك صلاحيات كافية على Google Sheets
- لا تشارك رابط النشر مع أشخاص غير موثوقين
- يمكنك تقييد الوصول حسب الحاجة

### تحديث البيانات
- بعد الحذف، قد تحتاج لتحديث الصفحة لرؤية التغييرات
- تأكد من أن جميع المستخدمين لديهم أحدث إصدار من الكود

### استكشاف الأخطاء
إذا لم يعمل الحذف:
1. تحقق من وحدة تحكم المتصفح (F12)
2. تأكد من صحة معرفات الجداول
3. تحقق من صلاحيات Google Apps Script

## الدعم

إذا واجهت أي مشاكل:
1. تحقق من وحدة تحكم المتصفح للأخطاء
2. تأكد من صحة جميع المعرفات
3. جرب الحل البديل (Google Form)
4. استخدم الحذف اليدوي كحل مؤقت

---

**ملاحظة**: Google Apps Script هو الحل الأفضل والأكثر أماناً، لكنه يتطلب إعداداً أولياً.
