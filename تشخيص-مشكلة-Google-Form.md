# تشخيص مشكلة عدم حفظ البيانات في Google Form

## المشكلة
البيانات لا تُحفظ في Google Form بعد إضافة حقل قيمة التبرع.

## خطوات التشخيص

### 1. تحقق من Google Form

#### أ) فتح Google Form
1. اذهب إلى [Google Forms](https://forms.google.com/)
2. افتح النموذج الموجود
3. تأكد من وجود الحقول التالية:
   - اسم المحل
   - رقم الهاتف  
   - الموقع
   - **قيمة التبرع** (الجديد)

#### ب) التحقق من نوع الحقل
- تأكد أن حقل "قيمة التبرع" من نوع **Multiple Choice**
- تأكد من وجود الخيارات:
  - نصف دينار
  - دينار واحد
- تأكد من تفعيل "Required" (مطلوب)

#### ج) الحصول على معرف الحقل الصحيح
1. اضغط على "Send" (إرسال)
2. اضغط على "Link" (رابط)
3. انسخ الرابط
4. ابحث عن `entry.` متبوعاً بأرقام
5. مثال: `entry.1491420652`

### 2. اختبار النموذج يدوياً

#### أ) اختبار مباشر
1. افتح الرابط المباشر للنموذج
2. املأ البيانات يدوياً
3. اضغط "Submit"
4. تحقق من Google Sheets

#### ب) إذا لم يعمل الاختبار اليدوي
- تأكد من أن النموذج مفتوح للجميع
- تحقق من إعدادات الخصوصية

### 3. تشخيص الكود

#### أ) فتح وحدة التحكم
1. اضغط F12 في المتصفح
2. اذهب إلى تبويب "Console"
3. جرب تسجيل محل جديد
4. راقب الرسائل

#### ب) الرسائل المتوقعة
```
البيانات المرسلة:
اسم المحل: [اسم المحل]
الهاتف: [رقم الهاتف]
الموقع: [الموقع]
قيمة التبرع: [0.5 أو 1]
معرفات الحقول:
اسم المحل: entry.1849007154
الهاتف: entry.163395635
الموقع: entry.301846562
قيمة التبرع: entry.1491420652
FormData المحتوى:
entry.1849007154 : [اسم المحل]
entry.163395635 : [رقم الهاتف]
entry.301846562 : [الموقع]
entry.1491420652 : [0.5 أو 1]
تم إرسال البيانات بنجاح
```

### 4. المشاكل المحتملة والحلول

#### المشكلة 1: معرف الحقل خاطئ
**الحل:**
- تأكد من صحة معرف الحقل
- جرب معرفات أخرى من النموذج

#### المشكلة 2: نوع الحقل خاطئ
**الحل:**
- غير نوع الحقل إلى "Multiple Choice"
- تأكد من القيم المحفوظة

#### المشكلة 3: النموذج غير مفتوح
**الحل:**
- تأكد من إعدادات الخصوصية
- جرب مشاركة النموذج مع نفسك

#### المشكلة 4: مشكلة في CORS
**الحل:**
- هذا طبيعي مع `mode: "no-cors"`
- البيانات تُحفظ رغم عدم ظهور رسالة خطأ

### 5. اختبار بديل

#### أ) إنشاء نموذج جديد
1. أنشئ Google Form جديد
2. أضف نفس الحقول
3. احصل على المعرفات الجديدة
4. حدث الكود

#### ب) استخدام Google Apps Script
1. أنشئ Google Apps Script
2. استخدم `doPost` function
3. احفظ البيانات مباشرة في Sheets

### 6. التحقق من النجاح

#### أ) في Google Sheets
1. افتح Google Sheets المرتبط
2. تحقق من وجود البيانات الجديدة
3. تأكد من وجود عمود "قيمة التبرع"

#### ب) في الموقع
1. اذهب إلى قائمة المحلات
2. تحقق من عرض قيمة التبرع
3. جرب تسجيل فاتورة جديدة

## نصائح إضافية

### 1. انتظار التحديث
- قد تحتاج لانتظار 1-2 دقيقة بعد التحديث
- جرب تحديث الصفحة

### 2. مسح الذاكرة المؤقتة
- اضغط Ctrl+F5 لتحديث كامل
- أو امسح cache المتصفح

### 3. اختبار في متصفحات مختلفة
- جرب Chrome, Firefox, Edge
- تأكد من عمل النموذج في جميعها

---

## إذا لم تحل المشكلة

1. **انسخ رسائل وحدة التحكم** وأرسلها
2. **تحقق من Google Sheets** وأرسل لقطة شاشة
3. **جرب النموذج اليدوي** وأخبر بالنتيجة
4. **تحقق من معرفات الحقول** في Google Form

**ملاحظة**: في معظم الحالات، المشكلة تكون في معرف الحقل أو نوع الحقل في Google Form.